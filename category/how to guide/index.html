<!DOCTYPE html>
<html lang="en">
<head>
    <title>Blog - Iron Foundry</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link href="/stylesheets/bootstrap.css" rel="stylesheet">
<script type="text/javascript" src="http://use.typekit.net/xvy7ell.js"></script> <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4936699-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>

<div id="wrap">
    <header class="header-short backsplash blog">
        <div class="container menu">
            <div class="navbar">
  <div class="container">
  	<!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <div class="navbar-brand"><a href="/"><img src="/img/logo-ironfoundry.png" alt="Iron Foundry" /></a></div>
    <div class="nav-collapse collapse navbar-responsive-collapse">
      <ul class="nav navbar-nav menu pull-right">
          
            
            
            

            <li class="">
              <a href="http://app.ironfoundry.me/download">Downloads</a>
            </li>
          
            
            
            

            <li class="">
              <a href="http://app.ironfoundry.me/signup">Sign Up</a>
            </li>
          
            
            
            

            <li class="">
              <a href="/blog">Blog</a>
            </li>
          
            
            
            

            <li class="">
              <a href="/help">Help</a>
            </li>
          
            
            
            

            <li class="">
              <a href="/about">About</a>
            </li>
          
          <li class="fork"><iframe src="http://ghbtns.com/github-btn.html?user=IronFoundry&repo=IronFoundry&type=fork&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="81" height="31"></iframe></li>
      </ul>
    </div>
  </div>
</div>
        </div>
        <div class="container">
            <div class="row hero">
                <h1 class="text-center">BLOG</h1>
            </div>
        </div>
        <div class="container photo-credit hidden-xs">
            <div class="photo-author">photo by Nathan Young</div>
        </div>
    </header>
        
    <div class="container content-container">
        <div class="row">
    <div class="col-lg-10">
		
			<h2>Category: 'how to guide'</h2>		
		
		<hr />

        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Richard Seroter
                            
                        </div>
                        
                            <div class="author-url"><a href="http://www.twitter.com/rseroter">@rseroter</a></div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/11/08/building-iron-foundry-apps-that-leverage-windows-azure-acs-for-user-authentication/">Building Iron Foundry Apps that Leverage Windows Azure ACS for User Authentication</a></h2>
                    <div class="post-date">
                        Posted in how to guide, iron foundry,  &#183; November 08, 2012 
                        	<div class="hidden-lg">
                        	
                                 by Richard Seroter
                            
                            
	                            <a href="http://www.twitter.com/rseroter">@rseroter</a>
	                        
                            </div>
                    </div>
                    <p><p>Iron Foundry and other PaaS frameworks are built to deliver a set of services to developers for building applications. While we think Iron Foundry has a great set of web, data and messaging services available, it by no means includes everything that a developer can use to craft a cool web app. Ideally, a developer can mix and match services from multiple PaaS providers in order to get everything that’s needed to solve a particular problem. For instance, what if an Iron Foundry developer wants to build a .NET application that lets users log in with credentials from a trusted provider? In this blog post, <strong>I’ll show you how to do user authentication/authorization in an Iron Foundry ASP.NET app by using the Windows Azure Access Control Service (ACS)</strong>.</p>

<h3>What is Windows Azure ACS?</h3>
<p><a href="http://msdn.microsoft.com/library/gg429786.aspx" target="_blank">Windows Azure ACS</a> is essential a claims transformation engine that connects to trusted web identity providers (e.g. Facebook, Google, Windows Live, Yahoo) and custom identity providers (e.g. through Active Directory Federation Services), and authenticates the user before passing along a set of claims to your web application. It provides developers a way to outsource the identity management part of their application. ACS itself doesn’t store credentials or act as an identity provider, but rather, it acts as a middleman that can take a series of input claims (e.g. “Google username”, “Windows logon ID”) and transform them into a single claim (“user ID”) used by your app. It’s a cool way to get your application out of the business of handling unique identity providers or storing credentials.</p>

<p>Let’s walk through the steps to building a simple, secure web app that we can deploy to Iron Foundry.</p>
<h3>Step 1 - Create new ASP.NET MVC 4 (internet) application</h3>
<p>To get started, I built a new ASP.NET MVC application in Visual Studio 2012.</p>

<img title="2012-11-07-compapp01" src="/img/blog/2012-11-07-compapp01.png" alt="2012-11-07-compapp01" width="600" height="543" border="0" />

<p>Once the project was created from the MVC4 template, I simply built it and ran it. You can see the default website and notice that I can register for an account. At this point, what this does is store my credentials in the default membership provider (which is a local database). I don’t want that as my long term solution. I want to let users log in with their web identity provider of choice.</p>

<img title="2012-11-07-compapp02" src="/img/blog/2012-11-07-compapp02.png" alt="2012-11-07-compapp02" width="500" height="281" border="0" />

<h3>2. Configure Access Control Service to Recognize Our Iron Foundry Application</h3>
<p>Virtually every Windows Azure service has migrated from the clunky Silverlight portal to the new, clean HTML portal. Unfortunately, Windows Azure ACS still lives in the old portal. Once I regretfully logged into it, I saw the options to add/configure identity providers, set up the relying party applications (like the one I created), and define the claims transformation rules.</p>

<img title="2012-11-07-compapp08" src="/img/blog/2012-11-07-compapp08.png" alt="2012-11-07-compapp08" width="500" height="403" border="0" />

<p>If I wanted to add ADFS as a valid identity provider, I could do that here. Instead, since I used existing web identity providers, I could jump right to the “relying party applications” section. On the first part of this form, I set the friendly name of the application, and the URL that will receive the claims. Initially (until I deployed to Iron Foundry) this was a local address on my machine.</p>

<img title="2012-11-07-compapp09" src="/img/blog/2012-11-07-compapp09.png" alt="2012-11-07-compapp09" width="450" height="437" border="0" />

<p>Further down this form, I was asked which (configured) identity providers I wished to use, whether or not to create a new set of claims transformation rules, and what certificate to use for signing the tokens.</p>

<img title="2012-11-07-compapp10" src="/img/blog/2012-11-07-compapp10.png" alt="2012-11-07-compapp10" width="300" height="323" border="0" />

<p>After saving my relying party entry, I jumped to the “Rule Groups” section of this portal to configure the transformation rules. I chose the option to “generate rules” for all the available identity providers, and was left with a series of “passthrough” rules that take whatever claim value was issued by the identity provider and ships it, as is, to my application.</p>

<img title="2012-11-07-compapp11" src="/img/blog/2012-11-07-compapp11.png" alt="2012-11-07-compapp11" width="350" height="440" border="0" />

<p>An individual one of these rules, such as the “Google name” one, has an input claim type and value, and an output claim type and value. While the one below has the same type and passthrough value, you can imagine how you might have three different providers with different input claim types/values all map to a single, internally-defined claim type and/or value.</p>

<img title="2012-11-07-compapp12" src="/img/blog/2012-11-07-compapp12.png" alt="2012-11-07-compapp12" width="450" height="490" border="0" />

<h3>3. Configure ASP.NET App to use ACS for Identity Management</h3>
<p>With my ACS configuration complete (for now), I returned to Visual Studio 2012 to make it “ACS aware.” Now there is a great new tool for Visual Studio 2012 and the latest Windows Identification Foundation bits (which you can see by grabbing the <a href="http://visualstudiogallery.msdn.microsoft.com/e21bf653-dfe1-4d81-b3d3-795cb104066e" target="_blank">Identity and Access Tools</a>), but since Iron Foundry doesn’t yet support .NET 4.5, I wasn’t able to use the wizard tooling. The latest WIF only applies to .NET 4.5, so I jumped back to using WIF 3.5. To easily grab this version, simply add the NuGet package for <strong>Windows Identification Foundation</strong> to a project.</p>

<img title="2012-11-07-compapp22" src="/img/blog/2012-11-07-compapp22.png" alt="2012-11-07-compapp22" width="450" height="257" border="0" />

<p>With all the proper assemblies in place, I then manually updated my web.config file to reflect my use of WIF and ACS. You can find my complete web.config file below. To learn more about the significance of each section, I’d recommend the blog post <a href="http://blogs.msdn.com/b/alikl/archive/2010/10/06/windows-identity-foundation-wif-configuration-sections-in-asp-net-web-config.aspx" target="_blank">Windows Identity Foundation (WIF) Configuration Sections in ASP.NET Web.Config</a>.</p>
<script src="https://gist.github.com/4040128.js"> </script>

<p>That’s about it. Clearly if I wanted to customize the handling of these claims (e.g. show the value of a claim besides “name” on the home page), there’s additional work I’d want to do in my code. When I ran this application, I was quickly prompted for credentials and the ACS site served up a page for me to select which identity provider to use.</p>

<img title="2012-11-07-compapp14" src="/img/blog/2012-11-07-compapp14.png" alt="2012-11-07-compapp14" width="450" height="340" border="0" />

<p>When I chose the Google provider, I was redirected to the Google accounts page and asked to log in.</p>

<img title="2012-11-07-compapp15" src="/img/blog/2012-11-07-compapp15.png" alt="2012-11-07-compapp15" width="450" height="262" border="0" />

<p>Once I logged into my account, I was returned to my custom web app which recognized that I was now authenticated!</p>

<img title="2012-11-07-compapp16" src="/img/blog/2012-11-07-compapp16.png" alt="2012-11-07-compapp16" width="450" height="396" border="0" />

<p>To prove that this is an account that wasn’t managed by my application itself, I clicked on my name to “manage” my user. I was presented a message indicating that there’s no local password for this user, as the identity provider was NOT my local membership provider.</p>

<img title="2012-11-07-compapp17" src="/img/blog/2012-11-07-compapp17.png" alt="2012-11-07-compapp17" width="450" height="219" border="0" />

<h3>4. Update and Deploy the App to Iron Foundry Environment</h3>
<p>The final task was to update the ASP.NET application and ACS configurations before deploying the application to Iron Foundry. First, I returned to the Windows Azure ACS portal to change the “realm” of the relying party entry that I created for my custom application. I planned on deploying this application to the <a href="http://ironfoundry.org/signup" target="_blank">free IronFoundry.me</a> environment, so I entered the expected destination of the application.</p>

<img title="2012-11-07-compapp18" src="/img/blog/2012-11-07-compapp18.png" alt="2012-11-07-compapp18" width="450" height="350" border="0" />

<p>After saving this change, I returned to my Visual Studio project and entered that same IronFoundry.me URL into the web.config file where the “localhost” value had been before. After publishing the website to the file system and executing a Cloud Foundry <strong>vmc push</strong> command from my Command console, my app was quickly deployed.</p>

<img title="2012-11-07-compapp20" src="/img/blog/2012-11-07-compapp20.png" alt="2012-11-07-compapp20" width="500" height="253" border="0" />

<p>Did it work? I browsed my newly published app on Iron Foundry, and just as with the local site, I was prompted for which identity provider to use. After selecting Google and plugging in my credentials, I saw my logged in user on the website.</p>

<img title="2012-11-07-compapp21" src="/img/blog/2012-11-07-compapp21.png" alt="2012-11-07-compapp21" width="500" height="489" border="0" />

<p>Cool! This is a fun case of being able to use the public/private Iron Foundry PaaS but still take advantage of other useful services offered by other PaaS solutions.</p>

</p>
                    <a href="/2012/11/08/building-iron-foundry-apps-that-leverage-windows-azure-acs-for-user-authentication/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/10/03/iron-foundry-vcap-client-aka-the-net-cloud-foundry-vcap-client/">Iron Foundry vcap-client (AKA The .NET Cloud Foundry vcap-client)</a></h2>
                    <div class="post-date">
                        Posted in how to guide, iron foundry, vcap,  &#183; October 03, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p><a href="http://www.nuget.org/packages/IronFoundry-VcapClient" rel="attachment wp-att-177"><img class="size-full wp-image-177 alignright" src="/img/blog/nuget_35366349.png" alt="" width="229" height="64" /></a>Ever want to write code against the Cloud Foundry API but you don't want to go to the trouble of wrapping up the API calls with library? Well, have no fear there's no need to! With dilligent work from the Iron Foundry team, a few suggestions from outside, and a few contributions from the community we've pulled this together for you. Here's a step by step of what we've accomplished in the last week to bring a solid, clean and tested library to you.

</p>
                    <a href="/2012/10/03/iron-foundry-vcap-client-aka-the-net-cloud-foundry-vcap-client/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/09/26/administering-postgresql-and-mysql-application-instances-in-iron-foundry/">Managing PostgreSQL and MySQL Application Instances in Iron Foundry</a></h2>
                    <div class="post-date">
                        Posted in how to guide, iron foundry, release, vmc,  &#183; September 26, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p>One reasonable concern with PaaS platforms is whether or not developers can easily access and administer backend application services. Iron Foundry database services such as PostgreSQL and MySQL have very strong management tools that you don't want to abandon when working with a PaaS instance. In this post, we'll look at how to wire up existing database management tools to PostgreSQL and MySQL.
<h2>PostgreSQL</h2>
PostgreSQL (discussed in this <a href="http://blog.ironfoundry.org/2012/08/choosing-the-right-database-option-for-your-iron-foundry-applications/" target="_blank">previous Iron Foundry blog post</a>), is a very popular open source database. Developers or database administrators typically use the <a href="http://www.pgadmin.org/" target="_blank">pgAdmin tool</a> to author and debug <a href="http://www.pgadmin.org/docs/1.16/query.html" target="_blank">queries</a>, perform database <a href="http://www.pgadmin.org/docs/1.16/backup.html" target="_blank">backups</a>/<a href="http://www.pgadmin.org/docs/1.16/restore.html" target="_blank">restorations</a>, <a href="http://www.pgadmin.org/docs/1.16/maintenance.html" target="_blank">reindex and cleanup (VACUUM) data</a>,  manage <a href="http://www.pgadmin.org/docs/1.16/pgagent-jobs.html" target="_blank">server jobs</a>, and much more.

You can download the pgAdmin tool <a href="http://www.pgadmin.org/download/" target="_blank">directly</a>, or find it included in the <a href="http://www.enterprisedb.com/products-services-training/pgdownload" target="_blank">PostgreSQL package</a> itself. For this demonstration, I installed PostgreSQL locally and got the pgAdmin tool along with it. After installing the database software, I opened a command prompt on my Windows machine and targeted my Iron Foundry environment.

<img class="alignnone size-full wp-image-152" title="dbadmin01" src="/img/blog/dbadmin01.png" alt="" width="450" height="289" />

After authenticating myself, I issued a vmc command ("<strong>vmc services</strong>") to see which application services were available, and which services I had already provisioned.

<img class="alignnone size-full wp-image-153" title="dbadmin02" src="/img/blog/dbadmin02.png" alt="" width="450" height="242" />

So far, no application services were provisioned. Let's change that. I created a new PostgreSQL instance by issuing the vmc command <strong>vmc create-service postgresql</strong>. Note that I didn't need to bind it to an application and can simply create a standalone instance that could be used by many Iron Foundry web applications.

<img class="alignnone size-full wp-image-154" title="dbadmin03" src="/img/blog/dbadmin03.png" alt="" width="450" height="303" />

Now there was a running instance of PostgreSQL in my environment. At this stage, there was no way for the pgAdmin tool to access this instance. However, thanks to the Cloud Foundry <a href="http://blog.ironfoundry.org/2012/04/caldecott-with-ms-sql-server/" target="_blank">Caldecott</a> technology, I could create a secure tunnel for pgAdmin. The <strong>vmc tunnel &lt;instance name&gt;</strong> command opens up a port that pgAdmin can use to administer that database server.

<img class="alignnone size-full wp-image-155" title="dbadmin04" src="/img/blog/dbadmin04.png" alt="" width="450" height="284" />

I could have chosen to use the psql client which would have let me issue commands right here in the command prompt, but since I wanted to use the full-featured pgAdmin tool, I selected the "none" client. Notice that I got four key pieces of information back: username, password, name and port. Together, these data points will get us logged into our environment.

I opened the pgAdmin tool and could see that the only server currently recognized was the one on my local machine.

<img class="alignnone size-full wp-image-156" title="dbadmin05" src="/img/blog/dbadmin05.png" alt="" width="450" height="330" />

I clicked the "Add a connection to a server" and was shown the "New Server Registration" prompt. For the "Name" value, I used the "name" that came back from the tunnel command; for "Host" value I set it to "localhost"; for the "Port" I used "10000"; and for the Username and Password, I used the corresponding values returned by the tunnel command.

<img class="alignnone size-full wp-image-157" title="dbadmin06" src="/img/blog/dbadmin06.png" alt="" width="450" height="470" />

Once connected, I could navigate all the database artifacts and browse the standard options for backing up data, querying tables, and creating new tables.

<img class="alignnone size-full wp-image-158" title="dbadmin07" src="/img/blog/dbadmin07.png" alt="" width="450" height="330" />

The pgAdmin tool is a very handy and useful way to manage your database artifacts and Iron Foundry makes it easy to use this tool against your application services.
<h2>MySQL</h2>
MySQL is also a very popular open source database and we want to make sure that database developers and administrators can use familiar tooling even if their application instance sits in a PaaS like Iron Foundry.

The MySQL team has made significant investments in their Workbench tool, and here we'll see exactly how you hook the Workbench up to an Iron Foundry instance. First, I downloaded the<a href="http://dev.mysql.com/downloads/workbench/5.2.html" target="_blank"> standalone Workbench tool</a>.

Then, I added a new MySQL instance to my Iron Foundry environment by using the <strong>vmc create-service mysql</strong> command.

<img class="alignnone size-full wp-image-159" title="dbadmin08" src="/img/blog/dbadmin08.png" alt="" width="450" height="312" />

Like the PostgreSQL example prior, I created a tunnel so that the MySQL Workbench tool could "see" our Iron Foundry instance. As before, I also chose the "none" client so that I could connect the GUI tool instead of issuing command statements only.

<img class="alignnone size-full wp-image-162" title="dbadmin09" src="/img/blog/dbadmin091.png" alt="" width="450" height="300" />

Notice that I got back database credentials ("username"/"password"), a schema instance name ("name"), and a port number.

I was now ready to connect the MySQL Workbench to my database instance. The Workbench has three core functions: <a href="http://dev.mysql.com/doc/workbench/en/wb-sql-development.html" target="_blank">SQL development</a>, <a href="http://dev.mysql.com/doc/workbench/en/wb-data-modeling.html" target="_blank">data modeling</a>, and <a href="http://dev.mysql.com/doc/workbench/en/wb-server-administration.html" target="_blank">server administration</a>.

<img class="alignnone size-full wp-image-161" title="dbadmin10" src="/img/blog/dbadmin10.png" alt="" width="450" height="328" />

In this example, I created a new pair of tables, and deployed them to the database instance in Iron Foundry. In the Workbench, I clicked the "Create New EER Model" in order to generate a data model. The first thing that I did was right-click the schema name and choose "Edit Schema." On the subsequent window, I changed the default "mydb" name to the the "name" value returned by the vmc tunnel command.

<img class="alignnone size-full wp-image-163" title="dbadmin11" src="/img/blog/dbadmin11.png" alt="" width="450" height="328" />

I then chose to add a new diagram to the model and proceeded to create a pair of new tables, "customer" and "order", and defined a relationship between them.

<img class="alignnone size-full wp-image-164" title="dbadmin12" src="/img/blog/dbadmin12.png" alt="" width="450" height="494" />

With the model complete, I chose the "Forward Engineer" option so that this model could be used to generate the actual tables.

<img class="alignnone size-full wp-image-165" title="dbadmin13" src="/img/blog/dbadmin13.png" alt="" width="450" height="267" />

I was then prompted to create an actual connection to the target database, and this is where the tunnel-provided values came into play. I plugged in the username and password, and set the Hostname value to "localhost" and the Default Schema to the tunnel-provided "name" value.

<img class="alignnone size-full wp-image-166" title="dbadmin14" src="/img/blog/dbadmin14.png" alt="" width="450" height="183" />

I then kept the remaining default options, including the selection of the two tables to forward engineer, and reviewed the pending SQL Script to be executed. After successfully completing the wizard, I could open an instance of the SQL Editor and browse my schema.

<img class="alignnone size-full wp-image-167" title="dbadmin15" src="/img/blog/dbadmin15.png" alt="" width="328" height="568" />

Sure enough my two tables, relationship included, were there.
<h2>Summary</h2>
While one of the key benefits of a PaaS is managed services, it's important to have the option to administer these application services using the powerful,  familiar management tools currently available to users. Both PostgreSQL and MySQL have solid management interfaces and we saw here how you can tunnel into these Iron Foundry database instances  and perform standard operations against your service.


</p>
                    <a href="/2012/09/26/administering-postgresql-and-mysql-application-instances-in-iron-foundry/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/09/12/contribute-to-iron-foundry/">Contribute to Iron Foundry, Here's How!</a></h2>
                    <div class="post-date">
                        Posted in how to guide, iron foundry,  &#183; September 12, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p>We've been asked a few times, "<em>what's the quickest, easiest and fastest way to get the code, build it and contribute back to Iron Foundry?</em>" Here's a quick start for doing just that.

</p>
                    <a href="/2012/09/12/contribute-to-iron-foundry/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/08/22/iron-foundry-adds-microsoft-service-bus-as-a-new-application-service/">Iron Foundry Adds Microsoft Service Bus as a New Application Service</a></h2>
                    <div class="post-date">
                        Posted in how to guide, iron foundry, release, vmc,  &#183; August 22, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p>Microsoft recently released a beta version of their <a href="http://msdn.microsoft.com/en-us/library/windowsazure/jj193027(v=azure.10).aspx" target="_blank">Service Bus for Windows</a> messaging technology, and the Iron Foundry team has now added this as an available service in Iron Foundry. The Service Bus for Windows is a scaled down version of the <a href="https://www.windowsazure.com/en-us/home/features/messaging/" target="_blank">Service Bus</a> product included in their Windows Azure cloud offering. The Service Bus for Windows, which supports brokered message through both traditional <a href="https://www.windowsazure.com/en-us/develop/net/how-to-guides/service-bus-queues/" target="_blank">Queues</a> and multi-subscriber <a href="https://www.windowsazure.com/en-us/develop/net/how-to-guides/service-bus-topics/" target="_blank">Topics</a>, provides Iron Foundry developers yet another option when building distributed applications.

Our awesome dev team followed the standard steps for adding new application services to a Cloud Foundry / Iron Foundry environment and also used a <a href="http://seroter.wordpress.com/2012/07/17/installing-and-testing-the-new-service-bus-for-windows/" target="_blank">previous write-up of mine</a> to guide the software installation. We’ve already updated the <a href="https://github.com/IronFoundry/vcap-services" target="_blank">vcap-services source code into Github</a> and you can clone the <a href="https://github.com/IronFoundry/vcap-services/tree/ironfoundry/mssb" target="_blank">mssb</a> (Microsoft Service Bus) directory today. There were also changes to the <a href="https://github.com/IronFoundry/ironfoundry/tree/master/src/IronFoundry.Dea" target="_blank">.NET DEA</a> to account for this new service and handing credentials back to the user. The Service Bus for Windows uses Microsoft SQL Server for its persistence tier, so we’ve tied the service to the instance of SQL Server that runs in Iron Foundry. <strong>Our hosted ironFoundry.me environment is running this today,</strong> and we’ve provisioned a shared Service Bus farm and host that holds each consumer’s individual namespace. Let’s see a demonstration of this in action!

To make life easier, we’ve built a sample web application that interacts with Service Bus Queues. We’ll start by looking at that application, and then deploy the application to Iron Foundry. The application contains a few ASP.NET Web Forms and a helper class. The helper class (<strong>QueueManager.cs</strong>)  contains a singleton that upon startup, parses Iron Foundry-provided URLs and credentials encoded as JSON in the application’s web.config file and uses those parameters to instantiate the core objects in the <a href="http://nuget.org/packages/ServiceBus.v1_0" target="_blank">Windows Service Bus SDK</a>.

<script src="https://gist.github.com/3429427.js"> </script>

Then we have some static operations for both sending to and receiving from the Service Bus Queue.

<script src="https://gist.github.com/3429452.js"> </script>

These operations are used in the pair of core ASP.NET pages to send and receive messages. Let’s now deploy this application to Iron Foundry and see how it works. Using vmc, I targeted the api.ironfoundry.me environment.

<img class="alignnone size-full wp-image-106" src="/img/blog/ironFoundryMssb02.png" alt="" width="450" height="236" />

I can confirm that the Service Bus for Windows is an available service by issuing a <strong>vmc services</strong> command.

<img class="alignnone size-full wp-image-107" src="/img/blog/ironFoundryMssb03.png" alt="" width="450" height="229" />

Great. Now let’s push this web application and provision an instance of this new service type. After publishing the ASP.NET web application to a file directory, I issued the <strong>vmc push</strong> command to start the deployment process.

<img class="alignnone size-full wp-image-108" src="/img/blog/ironFoundryMssb04.png" alt="" width="450" height="146" />

At this stage, I’m asked if I want to create a new service instance to bind to, or if I had already provisioned one, which instance I’d like to associate with. In this case, I have no existing services, so I’ll choose to create a new service.

<img class="alignnone size-full wp-image-109" src="/img/blog/ironFoundryMssb05.png" alt="" width="450" height="463" />

Within a matter of moments, my application is deployed and a new service instance is provisioned in the shared environment. This environment is not currently part of a Windows domain, so during service provisioning, a new local user is created and assigned to the developer’s own Service Bus namespace. All the URLs and credentials for the application are injected into the application’s web.config file. We can see this through vmc by viewing the file with the<strong> vmc files &lt;application name&gt; app/web.config</strong> command.

<img class="alignnone size-full wp-image-110" src="/img/blog/ironFoundryMssb06.png" alt="" width="450" height="451" />

These JSON-encoded values are then read by our application and used when authenticating the caller during Queue operations. Upon visiting the URL of the Iron Foundry application, we can see the option to send a message to a Queue.

<img class="alignnone size-full wp-image-111" src="/img/blog/ironFoundryMssb07.png" alt="" width="500" height="273" />

When we submit the message, it is added to a Queue, which means that it is persisted in a database. I then switch over to the “Receive” web form and choose to pull all of the messages from the Queue.

<img class="alignnone size-full wp-image-105" src="/img/blog/ironFoundryMssb08.png" alt="" width="500" height="253" />

The Service Bus for Windows is still in Beta, but we thought it would be fun to add this as an Iron Foundry service. You can <a href="/img/blog/IronFoundry.ServiceBusMessaging.WebUI_.zip" target="_blank">download the source code for this sample application from here</a>. Messaging is a core part of many modern web applications and the Service Bus for Windows gives Iron Foundry developers another way to link systems together.

<a rev="vote-for" href="http://dotnetshoutout.com/Iron-Foundry-Adds-Microsoft-Service-Bus-Support"><img alt="Shout it" src="http://dotnetshoutout.com/image.axd?url=http%3A%2F%2Fblog.ironfoundry.org%2F2012%2F08%2Firon-foundry-adds-microsoft-service-bus-as-a-new-application-service%2F" style="border:0px"/></a>


</p>
                    <a href="/2012/08/22/iron-foundry-adds-microsoft-service-bus-as-a-new-application-service/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/07/23/web_database_configuration_settings/">Deploying Web+Database Apps to Iron Foundry Without Changing Configuration Settings</a></h2>
                    <div class="post-date">
                        Posted in how to guide,  &#183; July 23, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p>One of the tricky things you’ll experience when working with PaaS platforms is that the local development environment won’t exactly mirror the targeted PaaS environment. While some cloud providers do a good job of having a local simulated fabric that closely mimics the cloud environment, it’s inevitable that SOME differences will exist.

In this post, I want to specifically focus on database connection strings. A connection string with “server=localhost” may be perfectly fine when running on a developer’s machine, but this won’t fly when we deploy an application elsewhere. In this example, I’ll show you how we can easily keep a local database connection string while leveraging the built-in connection string rewrite that’s baked into Iron Foundry.

I’ve got a ridiculously simple ASP.NET web form, and within it, a GridView that used a SqlDataSource to grab records from a database on my machine.

[caption id="attachment_77" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=77" rel="attachment wp-att-77"><img class="size-full wp-image-77" title="connstrings01" src="/img/blog/connstrings01.png" alt="Configuration File Markup" width="450" height="234" /></a> Configuration File Markup[/caption]

This application’s web.config file had a connection string (named “Default”) that included the details necessary to talk to the database.

[caption id="attachment_78" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=78" rel="attachment wp-att-78"><img class="size-full wp-image-78" title="connstrings02" src="/img/blog/connstrings02.png" alt="Default Connection String" width="450" height="138" /></a> Default Connection String[/caption]

With this robust website ready to go, I first published the site to the file system, and then spun up the Cloud Foundry Explorer tool.

[caption id="attachment_79" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=79" rel="attachment wp-att-79"><img class="size-full wp-image-79" title="connstrings03" src="/img/blog/connstrings03.png" alt="Cloud Foundry Explorer" width="450" height="166" /></a> Cloud Foundry Explorer[/caption]

I then chose which Iron Foundry environment to target with my “push.” In this case, I chose a Web Fabric instance hosted by Tier 3. During the push, I was asked to select the name of the application, code source location, resource needs, and which application services to bind to. I chose a Microsoft SQL Server application service.

[caption id="attachment_80" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=80" rel="attachment wp-att-80"><img class="size-full wp-image-80" title="connstrings04" src="/img/blog/connstrings04.png" alt="Push Application" width="450" height="347" /></a> Push Application[/caption]

In a few seconds, the application was deployed, and I could see it was up and running. All that remained was to get my local database provisioned into the cloud. Recall that Microsoft SQL Server is just one of many services available in Iron Foundry.

[caption id="attachment_81" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=81" rel="attachment wp-att-81"><img class="size-full wp-image-81" title="connstrings05" src="/img/blog/connstrings05.png" alt="Checking Services via the Iron Foundry VMC" width="450" height="415" /></a> Checking Services via the Iron Foundry VMC[/caption]

While I’ve previously demonstrated some funky ways to instantiate the underlying database in an Iron Foundry environment, we’ve since made it MUCH easier to tunnel into these databases. We now use the Cloud Foundry Caldecott process to connect to the Iron Foundry / Web Fabric SQL Server database service. With a simple command (“vmc tunnel SeroterSqlDb”) I connected my machine to the hosted environment and when the tunnel was set up, vmc returned my database credentials.

[caption id="attachment_82" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=82" rel="attachment wp-att-82"><img class="size-full wp-image-82" title="connstrings06" src="/img/blog/connstrings06.png" alt="Tunneling" width="450" height="521" /></a> Tunneling[/caption]

I could now fire up SQL Management Studio and log into the database with these credentials.

[caption id="attachment_83" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=83" rel="attachment wp-att-83"><img class="size-full wp-image-83" title="connstrings07" src="/img/blog/connstrings071.png" alt="SQL Server Management Studio (2008 R2)" width="450" height="324" /></a> SQL Server Management Studio (2008 R2)[/caption]

After generating a T-SQL script out of the local database, I ran that script against the cloud database and produced the necessary tables.

[caption id="attachment_84" align="aligncenter" width="277"]<a href="http://blog.ironfoundry.org/?attachment_id=84" rel="attachment wp-att-84"><img class="size-full wp-image-84" title="connstrings08" src="/img/blog/connstrings08.png" alt="Databases" width="277" height="413" /></a> Databases[/caption]

You may recall that the application’s original connection string targeted my local database. How did I update it with these new cloud database settings? The answer is: I didn’t have to! When we push a web application to Iron Foundry, and it is associated with an application service like SQL Server, the provisioning process injects the new database connection details into the web.config file of the web application. We can prove this by first finding our application in the Cloud Foundry Explorer.

[caption id="attachment_85" align="aligncenter" width="320"]<a href="http://blog.ironfoundry.org/?attachment_id=85" rel="attachment wp-att-85"><img class="size-full wp-image-85" title="connstrings09" src="/img/blog/connstrings09.png" alt="Databases Listed in Cloud Foundry Explorer" width="320" height="377" /></a> Databases Listed in Cloud Foundry Explorer[/caption]

When I double-clicked the web.config file, I could see that a series of “app settings” were added, and, the “Default” connection string was overwritten with the details of the cloud database. Note that the connection strong had to be named “Default” for this to work!

[caption id="attachment_86" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=86" rel="attachment wp-att-86"><img class="size-full wp-image-86" title="connstrings10" src="/img/blog/connstrings10.png" alt="Configuration" width="450" height="263" /></a> Configuration[/caption]

Sure enough, when we visit the application deployed to Tier 3’s Web Fabric, we can see that it correctly connects to the database and retrieves a set of records.

[caption id="attachment_87" align="aligncenter" width="450"]<a href="http://blog.ironfoundry.org/?attachment_id=87" rel="attachment wp-att-87"><img class="size-full wp-image-87" title="connstrings11" src="/img/blog/connstrings11.png" alt="Viewing the Site" width="450" height="193" /></a> Viewing the Site[/caption]

This is just one way that we’ve tried to make it easier to build your applications locally and confidently deploy them to an Iron Foundry cloud without requiring error-prone connection string synchronization tasks!


</p>
                    <a href="/2012/07/23/web_database_configuration_settings/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/04/05/caldecott-with-ms-sql-server/">Caldecott with MS SQL Server!</a></h2>
                    <div class="post-date">
                        Posted in community, how to guide, release, vmc,  &#183; April 05, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p>Yesterday we launched our new testing environment that you can read about. With that announcement we added support for <a href="http://blog.cloudfoundry.com/post/12928974099/now-you-can-tunnel-into-any-cloud-foundry-data-service">Caldecott</a> which allows you to tunnel from your environment to services in the Cloud Foundry environment. Today we have enabled MS SQL support with <a href="http://blog.cloudfoundry.com/post/12928974099/now-you-can-tunnel-into-any-cloud-foundry-data-service">Caldecott</a> into our <a href="http://www.ironfoundry.org/signup" target="_blank">.ME environment</a> and also our own version of the Cloud Foundry VMC that has all of the Iron Foundry support built in.

<strong>Install VMC Iron Foundry</strong>

Install Ruby for Windows from <a title="Ruby Installer" href="http://rubyinstaller.org/downloads/" target="_blank">Ruby Installer</a>. This is tested using version 1.9.3. During installation you can either add ruby to your PATH or add it manually later.

Run the following commands from a command prompt. You should ensure that ruby and sqlcmd are in your PATH as well.

Checking ruby version:
<pre>C:\&gt;ruby --version
ruby 1.9.3p125 (2012-02-16) [i386-mingw32]</pre>
<pre>C:\&gt;gem install vmc-ironfoundry --pre</pre>
<strong>Caldecott and MS SQL</strong>

To use Caldecott on Iron Foundry from a Windows machine to connect to a provisioned MS SQL database, follow these steps.

Install Ruby for Windows from <a title="Ruby Installer" href="http://rubyinstaller.org/downloads/" target="_blank">Ruby Installer</a>. This is tested using version 1.9.3. During installation you can either add ruby to your PATH or add it manually later.

Run the following commands from a command prompt. You should ensure that ruby and sqlcmd are in your PATH as well.

Checking ruby version:
<pre>C:\&gt;ruby --version
ruby 1.9.3p125 (2012-02-16) [i386-mingw32]</pre>
Ensuring that sqlcmd.exe is in your PATH. If not, it is located by default at

C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe
<pre>C:\&gt;sqlcmd /?
Microsoft (R) SQL Server Command Line Tool
Version 10.50.2500.0 NT x64
Copyright (c) Microsoft Corporation. All rights reserved.</pre>
Install the vmc-IronFoundry gem
<pre>C:\&gt;gem install vmc-IronFoundry --pre
Fetching: vmc-IronFoundry-0.3.16.IF.1.gem (100%)
Successfully installed vmc-IronFoundry-0.3.16.IF.1
1 gem installed
Installing ri documentation for vmc-IronFoundry-0.3.16.IF.1...
Installing RDoc documentation for vmc-IronFoundry-0.3.16.IF.1...</pre>
Target api.ironfoundry.me and log in to your account
<pre>C:\&gt;vmc target api.ironfoundry.me
Successfully targeted to [<a href="http://api.ironfoundry.me/">http://api.ironfoundry.me</a>]
C:\&gt;vmc login --email <a href="mailto:foo@bar.com">foo@bar.com</a> --passwd XXXYYYZZZ
Attempting login to [<a href="http://api.ironfoundry.me/">http://api.ironfoundry.me</a>]
Successfully logged into [<a href="http://api.ironfoundry.me/">http://api.ironfoundry.me</a>]</pre>
Provision an MS SQL database
<pre>C:\&gt;vmc create-service mssql
Creating Service [mssql-c902d]: OK</pre>
Tunnel to your database
<pre>C:\&gt;vmc tunnel mssql-c902d sqlcmd
Deploying tunnel application 'caldecott'.
Uploading Application:
 Checking for available resources: OK
 Packing application: OK
 Uploading (1K): OK
Push Status: OK
Binding Service [mssql-c902d]: OK
Staging Application 'caldecott': OK
Starting Application 'caldecott': OK
Getting tunnel connection info: OK
Service connection info:
 username : uxeBbNM0jYAFS
 password : psOmxGWibimeX
 name : d7dedaf7e01ae42568c07c44ec30bff99
Starting tunnel to mssql-c902d on port 10000.
Launching 'sqlcmd -S localhost,10000 -U uxeBbNM0jYAFS -P psOmxGWibimeX -d d7dedaf7e01ae42568c07c44ec30bff99'
1&gt;</pre>
You can now run commands from within sqlcmd against your database!
<pre>1&gt; select @@VERSION
2&gt; GO
Microsoft SQL Server 2008 R2 (SP1) - 10.50.2500.0 (X64)
 Jun 17 2011 00:54:03
 Copyright (c) Microsoft Corporation
 Enterprise Edition (64-bit) on Windows NT 6.1 &lt;X64&gt; (Build 7601: Service Pack 1) (Hypervisor)</pre>
In addition, you can use the displayed connection information to connect via SQL Management Studio. Just use localhost,10000 as the "Server name". Be sure to start the tunnel first and keep it open during the time you're using Management Studio. Quitting sqlcmd will close the tunnel.

<img src="http://help.ironfoundry.org/attachments/token/jzyoooizzrtrzfq/?name=connect_local.png" alt="connect_local.png" />


</p>
                    <a href="/2012/04/05/caldecott-with-ms-sql-server/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/02/23/how-to-deploy-orchard-cms-on-iron-foundry/">How To Deploy Orchard CMS on Iron Foundry</a></h2>
                    <div class="post-date">
                        Posted in cloud foundry explorer, how to guide, release, test environment,  &#183; February 23, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p><div class="grey_box_top"><span class="c2"><a class="c5" href="http://orchardproject.net/">Orchard </a></span>is a free, open source, community-focused project aimed at delivering applications and reusable components on the ASP.NET platform. The Orchard project as a very active and vibrant community that is actively developing and also using it for personal and commercial offerings.</div>
<div class="frame">
<div class="entry nobottom">
<div class="user_formatted header_section clearfix">
<p class="c0"><span class="c2"><a class="c5" href="http://www.ironfoundry.org/">Iron Foundry</a></span> is an open source project  that extends .NET to <span class="c2"><a class="c5" href="http://www.cloudfoundry.org/">Cloud Foundry</a></span> (The Open Platform as a Service). available for the Windows Server Environments with the ability to run the full spectrum of .NET Web Applications, SQL Server, and more. Iron Foundry places the Microsoft tool stack on an even footing with the Linux-based stacks. This platform is all open source and can be deployed anywhere. Today we are going to use the free trial environment provided by the Iron Foundry project.</p>
<p class="c0">With Iron Foundry and Cloud Foundry Orchard can scale within minutes to handle load on the system. This also gives an environment for rapid testing and staging of your application.</p>
<p class="c0">In four easy steps you can deploy and start configuring your Orchard CMS instance on Iron Foundry:</p>

<h2 class="c0">Step 1:  Download Orchard CMS</h2>
<p class="c0">To download Orchard just go to the <span class="c2"><a class="c5" href="http://orchardproject.net/download">Download Page</a></span> and then select the “Download as a zip” it is about 8MB in size. It will then ask you to agree to the terms.</p>
<p class="c0">Step 2:  Make changes to be supported on Iron Foundry</p>

<ol class="c6" start="1">
	<li class="c3 c0">Go ahead and unzip it to your temporary directory.</li>
</ol>
<p class="c0">You can read more about the manual install here:<span class="c2"><a href="http://docs.orchardproject.net/Documentation/Manually-installing-Orchard-zip-file">http://docs.orchardproject.net/Documentation/Manually-installing-Orchard-zip-file</a></span></p>

<h2 class="c0">Step 3:  Sign up and Deploy to Iron Foundry</h2>
<ol class="c6" start="1">
	<li class="c3 c0"><span class="c2"><a class="c5" href="http://www.ironfoundry.org/signup">Sign up </a></span>for your free account on <span class="c2"><a class="c5" href="http://www.ironfoundry.org/signup">Iron Foundry</a></span> so you can test your deployment. (Note: this can take up to 24 hours to get your account activated.)</li>
	<li class="c3 c0">Once your account is activated you can also download the <span class="c2"><a class="c5" href="http://www.ironfoundry.org/download">Cloud Foundry Explorer</a></span> from Iron Foundry.</li>
	<li class="c3 c0">After installing the Cloud Foundry explorer you will need to run the application.</li>
	<li class="c3 c0"><span class="c1">Upon startup, use the gear icon to add a connection to api.gofoundry.net:
</span><img src="http://help.ironfoundry.org/attachments/token/rkj8yswyipcbess/?name=image00.png" alt="image00.png" /></li>
</ol>
<ol class="c6" start="5">
	<li class="c3 c0"><span class="c1">You will be presented with the “Manage Clouds” screen (new in 1.6.0). To add a well-known cloud, use the dropdown at the bottom of the left side of the screen, with the cloud-plus icon. Select “Iron Foundry” to add a connection to this cloud. The url will be pre-filled to </span><span class="c7"><a href="http://api.gofoundry.net">http://api.gofoundry.net</a></span></li>
	<li class="c3 c0"><span class="c1">Enter the email address and password credentials that were mailed to you upon signup. Use the “Validate Account” button to double-check your entries<img src="http://help.ironfoundry.org/attachments/token/ywezokgqwx0wx6a/?name=image01.png" alt="image01.png" /></span><span class="c1"> </span></li>
	<li class="c3 c0"><span class="c1">When you choose “Ok”, you will see this new cloud connection added to your explorer window.
</span><img src="http://help.ironfoundry.org/attachments/token/du6v6vtgiksfcht/?name=image03.png" alt="image03.png" /></li>
</ol>
<ol class="c6" start="8">
	<li class="c3 c0"><span class="c1">Double-click the new connection to see an overview that will be displayed on the right.
<img src="http://help.ironfoundry.org/attachments/token/zt1hg7pr1dwt0xd/?name=image05.png" alt="image05.png" width="500" /> </span></li>
</ol>
<ol class="c6" start="9">
	<li class="c3 c0"><span class="c1">Next you will want to create an SQL instance to use. Main Iron Foundry Production tab at the bottom switch to “Applications” view.</span></li>
	<li class="c3 c0"><span class="c1">On the services click the button to create a new service. Create a name for it and then from the drop down select MS SQL.
<img src="http://help.ironfoundry.org/attachments/token/89zjf3dgckvyxp2/?name=image04.png" alt="image04.png" />
</span></li>
	<li class="c0 c3"><span class="c1">Use the “Push Application” button to push a new application to Iron Foundry:
</span><img src="http://help.ironfoundry.org/attachments/token/dtsikbnxwm6laah/?name=image02.png" alt="image02.png" /></li>
</ol>
<ol class="c6" start="12">
	<li class="c3 c0"><span class="c1">In the dialog, choose the cloud to which to push. Then, choose an application name that does not contain spaces. The url to specify will be in the form APPNAME.gofoundry.net, where APPNAME is the name you chose. Choose Browse… to pick the directory in which you unziped your orchard application. Note: this directory is the one in which a Web.config file and a bin subdirectory exists.<img src="http://help.ironfoundry.org/attachments/token/ha9b9ny3nnnrfvu/?name=image06.png" alt="image06.png" /></span></li>
	<li class="c3 c0"><span class="c1">Once push completes, browse to </span><span class="c1">APPNAME.gofoundry.net</span><span class="c1"> to see your deployed application.</span></li>
</ol>
<h2 class="c0">Step 4: Setup your new Orchard Instance</h2>
<p class="c0">You should be able to browse to your new orchard install at your application url (<span class="c2"><a href="http://APPNAME.gofoundry.net">http://APPNAME.gofoundry.net</a></span>) where you will see a getting started page:
<img src="http://help.ironfoundry.org/attachments/token/mvksyylxte7byvs/?name=image07.png" alt="image07.png" /></p>
<p class="c0">When you get to the screen below you are going to want to select to deploy SQL server and put in the connection string. To get the connection string you need to do the following:</p>

<ol class="c6" start="1">
	<li class="c3 c0">Go back to the Cloud Foundry Explorer</li>
	<li class="c3 c0">Once there browse to your cloud and then browse to your application</li>
	<li class="c3 c0">Once you have expanded to see the files double click on the web.config file which will open for you. In there you will see more entries added. All you need to do is copy the SQL server configuration settings and then put it into the orchard setup screen.
<img src="http://help.ironfoundry.org/attachments/token/kxh0kdrdz9d3udu/?name=image08.png" alt="image08.png" /></li>
</ol>
<div class="grey_box_top">Anybody deploying Orchard on Iron Foundry can <a href="http://www.ironfoundry.org/hamma">contribute</a> and get a free Iron Foundry shirt!</div>
<div class="frame"></div>
</div>
</div>
</div>


</p>
                    <a href="/2012/02/23/how-to-deploy-orchard-cms-on-iron-foundry/">Read More</a>
                </div>
            </div>
        
            <div class="row post-index">
                <div class="col-lg-4 visible-lg">
                    <div class="author-info pull-right">
                        <div class="author-name">
                            
                                Iron Foundry
                            
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-8 post">
                    <h2><a href="/2012/01/25/cloud-foundry-with-iron-foundry-windows-core-install/">Cloud Foundry with Iron Foundry (Windows Core) Install</a></h2>
                    <div class="post-date">
                        Posted in cloud foundry explorer, dea.net, how to guide,  &#183; January 25, 2012 
                        	<div class="hidden-lg">
                        	
                            
                            </div>
                    </div>
                    <p><div>
<p class="c0"><img src="http://help.ironfoundry.org/attachments/token/zapjj9ooku5eroq/?name=image05.png" alt="image05.png" width="608" height="145" /></p>
<p class="c0"><span>Cloud Foundry has been taking the web by storm. PaaS is growing in popularity as more developers find the disruptively positive deployment scenarios that are possible over traditional environments. Cloud Foundry, primarily centered around Linux-based PaaS, now has a sibling called Iron Foundry.</span></p>
<p class="c0"><span>Iron Foundry is an open source project available for the Windows Server Environments with the ability to run the full spectrum of .NET Web Applications, SQL Server, and more. IronFoundry places the Microsoft tool stack on an even footing with the Linux-based stacks.</span></p>
<p class="c0"><img src="http://help.ironfoundry.org/attachments/token/dse6cx1a3lzo1re/?name=image04.png" alt="image04.png" width="613" height="393" /></p>

<h2 class="c0"><span class="c2">Step 1:  Get IronFoundry Installed and Running by </span><span class="c6 c2"><a class="c8" href="http://twitter.com/adron">Adron Hall</a></span></h2>
<p class="c0"><span>The first thing you’ll need is to be sure to get a USB Thumb Drive or some mechanism to get the .NET 4.0 &amp; IronFoundry Software onto the Windows Server 2008 Core Instance. If you’re using a full install of Windows Server 2008 then you can use the normal means to retrieve this software. The files you’ll want on the external storage include:</span></p>

<ol class="c12" start="1">
	<li class="c3"><span>.NET 4.0 Framework for Server Core (</span><span class="c6"><a class="c8" href="http://www.microsoft.com/download/en/details.aspx?id=22833">dotNetFx40_Full_x86_x64_SC.exe</a></span><span>)</span></li>
	<li class="c3"><span>IronFoundry DEA Service (</span><span class="c6"><a class="c8" href="http://www.ironfoundry.org/download">IronFoundry.Dea.Service.x86.msi</a></span><span> or </span><span class="c6"><a class="c8" href="https://github.com/downloads/IronFoundry/ironfoundry/IronFoundry.Dea.Service.x64.msi">IronFoundry.Dea.Service.x64.msi</a></span><span>)</span></li>
</ol>
<p class="c0"><span>Once you have the software downloaded to a medium to use, get a solid image of </span><span class="c6"><a class="c8" href="http://compositecode.com/2012/01/16/windows-server-2008-core-a-quick-run-down/">Windows 2008 Server Core up and running</a></span><span>. With the Windows 2008 Server Core command prompt get the following services installed and started with the following commands:</span></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup IIS-WebServerRole</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup WAS-NetFxEnvironment</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup IIS-ISAPIExtensions</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup IIS-ISAPIFilter</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup IIS-NetFxExtensibility</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup IIS-ASPNET</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup MicrosoftWindowsPowerShell</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup ServerCore-WOW64</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup NetFx2-ServerCore</em></p>
<p class="c0 c10"><em>c:UsersMyUserNamestart /w ocsetup NetFx2-ServerCore-WOW64</em></p>
<p class="c0"><img src="http://help.ironfoundry.org/attachments/token/npfp0lgocjivhdz/?name=image01.png" alt="image01.png" width="693" height="355" /></p>
<p class="c0"><span>After these services are started, copy the software off of the USB / Storage Device that has .NET 4.0 and the IronFoundry DEA. In the below copy command, “e:” is the storage device.</span><span> </span></p>
<p class="c0"><em>        e:copy *.* c:UsersMyUserName</em></p>
<p class="c0"><span>Now execute the .NET 4.0 Framework (</span><span class="c6"><a class="c8" href="http://www.microsoft.com/download/en/details.aspx?id=22833">dotNetFx40_Full_x86_x64_SC.exe</a></span><span>) for Windows 2008 Server Core.</span></p>
<p class="c0"><em>        c:UsersMyUserNamedotNetFx40_Full_x86_x64_SC.exe</em></p>
<p class="c0"><span>From this point a standard Windows Wizard will display to step through the rest of the .NET 4.0 Server Core Installation. The next step is to enable IIS Remote Administration:</span><span> </span></p>
<p class="c0"><span>        c:UsersMyUserNamereg add HKEY_LOCAL_MACHINESOFTWAREMicrosoftWebManagementServer /v EnableRemoteManagement /t REG_DWORD /d 1</span></p>
<p class="c0"><span>At this point it is actually a good idea to reboot the server to insure all the services start correctly and the registry setting takes effect. I’m sure that just simply restarting the services might work, but when playing with the registry I like to stay safe and insure everything is set and has taken effect.</span></p>
<p class="c0"><span>After the reboot, start wmsvc.</span></p>
<p class="c0"><em>        c:UsersMyUserNamenet start wmsvc</em></p>
<p class="c0"><span>Now kick off the </span><span class="c6"><a class="c8" href="https://github.com/downloads/IronFoundry/ironfoundry/IronFoundry.Dea.Service.x64.msi">IronFoundry DEA Installation</a></span><span>. When the wizard prompts for configuration information, enter the following:</span></p>

<ol class="c12" start="1">
	<li class="c3"><span>NATS Host: 10.0.0.1</span></li>
	<li class="c3"><span>NATS Port: 4222</span></li>
	<li class="c3"><span>App Directory: C:IronFoundryapps</span></li>
	<li class="c3"><span>Droplet Directory: C:IronFoundrydroplets</span></li>
	<li class="c3"><span>Install Directory: C:Program FilesIron FoundryDEA</span></li>
</ol>
<p class="c0"><span>Once the wizard is complete, then go to c:Program FilesIron FoundryDEA and run the DEA executable. This will start the IronFoundry DEA Service and insure it kicks off (self starting) anytime the server may be rebooted.</span></p>

<h2 class="c0"><span class="c2">Step 2:  Deploy an ASP.NET MVC Application by </span><span class="c6 c2"><a class="c8" href="https://twitter.com/#!/jaredwray">Jared Wray</a></span></h2>
<p class="c0"><span class="c14">Deploying an ASP.NET MVC application could not be easier when using Iron Foundry and the accompanying tools. There are three ways to deploy your application to Iron Foundry:</span></p>

<ol class="c12" start="1">
	<li class="c3"><span>Visual Studio: The Iron Foundry plugin for Visual Studio allows you to push your application to any Cloud Foundry environment supporting .NET.</span></li>
	<li class="c3"><span>Cloud Foundry Explorer: The Cloud Foundry Explorer is a .NET Windows application that allows you to manage multiple cloud instances from a Windows desktop including all of the code and service deployment.</span></li>
	<li class="c3"><span>Command Line (VMC): This is the command line version with all of the features that you see from the plugin and explorer.</span></li>
</ol>
<p class="c0"><span>You can download these from Iron Foundry at: </span><span class="c6"><a href="http://www.ironfoundry.org/download">http://www.ironfoundry.org/download</a></span><span> </span></p>
<p class="c0"><strong>Getting down to code a deployment…</strong><span> </span></p>
<p class="c0"><span>Lets first start out with downloading and installing the Visual Studio Plugin from Iron Foundry. Go to </span><span class="c6"><a href="http://www.ironfoundry.org/download">http://www.ironfoundry.org/download</a></span><span> and download the latest. After it is downloaded double click the file and do the install.  After the install is done open up Visual Studio and go to Tools &gt; Extension Manager &gt; From there you should see it installed:</span></p>
<p class="c0"><img src="http://help.ironfoundry.org/attachments/token/itqsuvsnpodrrjx/?name=image00.png" alt="image00.png" width="491" height="61" /></p>
<p class="c0"><span>Lets go ahead and write a simple ASP.NET MVC (MVC 3 is being used in this and can be downloaded here: </span><span class="c6"><a href="http://www.asp.net/mvc">http://www.asp.net/mvc</a><a class="c8" href="http://www.asp.net/mvc)">)</a></span><span> application by creating a simple “Hello World” application for testing. In Visual Studio do the following:</span></p>

<ol class="c12" start="1">
	<li class="c3"><span>Go to File &gt; New Project</span></li>
	<li class="c3"><span>Select the ASP.NET MVC 3 Web Application, set the name, location, and solution name and click “ok”</span></li>
	<li class="c3"><span>On the next screen you will be prompted with the “Project Template” and you can select “Empty” and your view engine as “Razor”.</span></li>
</ol>
<p class="c0"><span>Now we have setup the project we are going to write a simple page and publish it to an Iron Foundry instance.</span></p>

<ol class="c12" start="1">
	<li class="c3"><span>From the Solution Explorer right click on the “Controllers” folder and go to Add &gt; Controller.</span></li>
	<li class="c3"><span>The “Add Controller” dialogue window will come up and name it “HomeController” then click the “Add” button.</span></li>
	<li class="c3"><span>Next step is to add the Index View for the Home controller. You can do this by the following:</span></li>
</ol>
<ol class="c13" start="1">
	<li class="c4"><span>Go to the “Views” folder &gt; Create a folder called “Home” inside it</span></li>
	<li class="c4"><span>Right click on the “Home” folder that was just created and Add &gt; View. Name the View “Index.”</span></li>
</ol>
<span>In the Views &gt; Home &gt; Index.cshtml file modify the code to be:
</span><img src="http://help.ironfoundry.org/attachments/token/8inunz2noc07acu/?name=image06.png" alt="image06.png" width="439" height="308" />
<p class="c0"><em><strong>(NOTE: Make sure you have compiled the site at least once before pushing it live for the first time.)</strong></em></p>
<p class="c0"><span>
</span></p>
<p class="c0"><span>With the </span><span class="c6"><a class="c8" href="http://www.ironfoundry.org/download">Visual Studio Plugin from Iron Foundry</a></span><span> it is very easy to do a deployment/update from. All you will need to do is define your Cloud Foundry instance with Iron Foundry support and then “Push” your application.</span></p>
<p class="c0"><span>Define your Cloud Foundry instance with Iron Foundry Support:</span></p>

<ol>
	<li>
<ol>
	<li class="c3"><span>From Visual Studio Go to Tools &gt; Cloud Foundry Explorer</span></li>
	<li class="c3"><span>From Cloud Foundry Explorer click the add new cloud button.</span><img alt="" /></li>
	<li class="c3"><span>Enter in the following data:</span>
<ol>
	<li class="c4"><span>Server Name: The friendly name of the Cloud Foundry instance you plan to connect to. For this example we will use the</span></li>
</ol>
</li>
</ol>
</li>
</ol>
<span class="c6"><a class="c8" href="http://www.ironfoundry.org/signup">Iron Foundry Trial</a></span><span> environment (api.gofoundry.net)</span>
<ol>
	<li>
<ol>
	<li class="c4"><span>Runtime Environment:  Select the correct runtime environment (right now it should default to: Cloud Foundry Runtime v1.0).</span></li>
	<li class="c4"><span>Register/Logon Info: The Email, and Password are what you need to logon to your Cloud Foundry instance.</span></li>
	<li class="c4"><span>URL: To setup the url of your cloud foundry instance do the following:</span></li>
</ol>
</li>
	<li class="c11"><span>Click on the “Manage Cloud…” button.</span></li>
	<li class="c11"><span>From the Manage Cloud Urls… window click “Add”</span></li>
	<li class="c11"><span>From the Add Cloud Url.. window type the Name and URL such as:</span>
<ol>
	<li class="c7"><span>Name: Iron Foundry Trial</span></li>
	<li class="c7"><span>Url: </span><span class="c6"><a href="http://api.gofoundry.net">http://api.gofoundry.net</a></span></li>
	<li class="c11"><span>Click Ok.</span></li>
</ol>
</li>
	<li class="c11"><span>From the Manage Cloud Urls… window verify that your URL has been added and click ok.
</span><img src="http://help.ironfoundry.org/attachments/token/w0bkq0arl7wrx3y/?name=image07.png" alt="image07.png" width="615" height="367" /><span> </span></li>
	<li class="c3"><span>Once you have entered the information correctly click to validate account and you will see an“Account Valid” message appear.</span></li>
	<li class="c3"><span>Close out the Cloud Foundry Explorer window as you are now ready to push your application!</span></li>
	<li><span>Push your Application (The Cool Stuff!)</span></li>
</ol>
<p class="c0"><span>Now that you have been able to setup your Cloud Foundry instance running Iron Foundry you can now push and update your application by doing the following:</span></p>

<ol>
	<li class="c3"><span>Right click on your project and then go to “Push Cloud Foundry Application…</span></li>
	<li class="c3"><img src="http://help.ironfoundry.org/attachments/token/s8pqmfuk0vqweuj/?name=image02.png" alt="image02.png" width="470" height="413" /></li>
	<li class="c3"><span>From the Push Cloud Foundry Application select the correct settings:</span></li>
	<li class="c4"><span>Cloud: Select the cloud you entered above.</span></li>
	<li class="c4"><span>Name: Enter in any name you want for the application.</span></li>
	<li class="c4"><span>URL: enter in the full url of the application. Here we will use </span><span class="c6"><a class="c8" href="http://helloworld23451.gofoundry.net/">helloworld23451.gofoundry.net</a></span><span>.</span></li>
	<li class="c4"><span>Memory Limit: Select the amount of memory you want your application to use.</span></li>
	<li class="c4"><span>Instances: Select the number of instances you want your application running on.</span></li>
	<li class="c4"><span>Select the services you want to bind to your application such as a database.</span></li>
</ol>
<p class="c0"><img src="http://help.ironfoundry.org/attachments/token/hiv9zl1l5wmatl9/?name=image03.png" alt="image03.png" width="596" height="497" /></p>
<p class="c0"><span>Click the “Push” and it will package it up and push it live doing all the configuration of the services and application into Cloud Foundry with Iron Foundry.</span></p>

</div>


</p>
                    <a href="/2012/01/25/cloud-foundry-with-iron-foundry-windows-core-install/">Read More</a>
                </div>
            </div>
        
    </div>
</div>

<hr />


	


<div class="row">    
    <div class="col-lg-6">
    
    </div>

    <div class="col-lg-6 text-right">
    
    </div>
</div>



<hr />
    </div>
    
    <div id="push"></div>
</div>
    
<footer>
    <div class="container">
    	<div class="row">
    		<div class="col-lg-12">
        <h4>Provided by Tier 3</h4>
        <p>Iron Foundry is a project initiated by <a href="http://www.tier3.com">Tier 3</a>, an enterprise cloud computing and hosting platform.</p>
        <p class="trademark"><a href="http://www.cloudfoundry.com" target="_blank">Cloud Foundry</a> and <a href="https://micro.cloudfoundry.com" target="_blank">Micro Cloud Foundry</a> are trademarks of <a href="http://pivotallabs.com" target="_blank">Pivotal Labs</a> in the United States and/or other jurisdictions.</p>
    		</div>
    	</div>
    </div>
</footer>

<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="/javascripts/bootstrap.min.js"></script>

</body>
</html>